<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.7
Version: 4.7.1
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
Renew Support: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
    <!--<![endif]-->
    <!-- BEGIN HEAD -->

    <head>
        <meta charset="utf-8" />
        <title>Se7en Cell</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta content="Preview page of Metronic Admin Theme #4 for bootstrap inputs, input groups, custom checkboxes and radio controls and more" name="description" />
        <meta content="" name="author" />
        <!-- BEGIN GLOBAL MANDATORY STYLES -->
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
        <!--<link href="../assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />-->

        <link href="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />

        <!-- END GLOBAL MANDATORY STYLES -->
        <!-- BEGIN THEME GLOBAL STYLES -->
        <link href="../assets/global/css/components-rounded.min.css" rel="stylesheet" id="style_components" type="text/css" />
        <link href="../assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
        <!-- END THEME GLOBAL STYLES -->
        <!-- BEGIN THEME LAYOUT STYLES -->
        <link href="../assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/layouts/layout4/css/themes/default.min.css" rel="stylesheet" type="text/css" id="style_color" />
        <link href="../assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
        <!-- END THEME LAYOUT STYLES -->
        <link rel="shortcut icon" href="favicon.ico" /> </head>
    <script src="../assets/global/plugins/jquery.min.js" type="text/javascript"></script>
    <script>
            $(function(){
            if(sessionStorage.getItem("jenis_role") == "admin" || true) {
                $("#sidebar_menu").load("./sidebar-menu.html");
            } else {
                $("#sidebar_menu").load("./sidebar-menu-user.html");
            }
        });
    </script>
    <!-- END HEAD -->

    <body class="page-container-bg-solid page-header-fixed page-sidebar-closed-hide-logo">
        <!-- BEGIN HEADER -->
        <div class="page-header navbar navbar-fixed-top">
            <!-- BEGIN HEADER INNER -->
            <div class="page-header-inner ">
                <!-- BEGIN LOGO -->
                <div class="page-logo">
                    <a href="report.html">
                        <img src="../assets/layouts/layout4/img/logo-light.png" alt="logo" class="logo-default" /> </a>
                    <div class="menu-toggler sidebar-toggler">
                        <!-- DOC: Remove the above "hide" to enable the sidebar toggler button on header -->
                    </div>
                </div>
                <!-- END LOGO -->
                <!-- BEGIN RESPONSIVE MENU TOGGLER -->
                <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>
                <!-- END RESPONSIVE MENU TOGGLER -->
                <!-- BEGIN PAGE ACTIONS -->
                <!-- DOC: Remove "hide" class to enable the page header actions -->

                <!-- END PAGE ACTIONS -->
                <!-- BEGIN PAGE TOP -->
                <div class="page-top">
                    <!-- BEGIN HEADER SEARCH BOX -->
                    <!-- DOC: Apply "search-form-expanded" right after the "search-form" class to have half expanded search box -->
                    <!--<form class="search-form" action="page_general_search_2.html" method="GET">-->
                        <!--<div class="input-group">-->
                            <!--<input type="text" class="form-control input-sm" placeholder="Search..." name="query">-->
                            <!--<span class="input-group-btn">-->
                                <!--<a href="javascript:;" class="btn submit">-->
                                    <!--<i class="icon-magnifier"></i>-->
                                <!--</a>-->
                            <!--</span>-->
                        <!--</div>-->
                    <!--</form>-->
                    <!-- END HEADER SEARCH BOX -->
                    <!-- BEGIN TOP NAVIGATION MENU -->
                    <div class="top-menu">
                        <ul class="nav navbar-nav pull-right">
                            <li class="separator hide"></li>
                            <!-- BEGIN NOTIFICATION DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            <!-- DOC: Apply "dropdown-hoverable" class after "dropdown" and remove data-toggle="dropdown" data-hover="dropdown" data-close-others="true" attributes to enable hover dropdown mode -->
                            <!-- DOC: Remove "dropdown-hoverable" and add data-toggle="dropdown" data-hover="dropdown" data-close-others="true" attributes to the below A element with dropdown-toggle class -->

                            <!-- END NOTIFICATION DROPDOWN -->
                            <li class="separator hide"></li>
                            <!-- BEGIN INBOX DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            <!-- END INBOX DROPDOWN -->
                            <li class="separator hide"></li>
                            <!-- BEGIN TODO DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            <!-- END TODO DROPDOWN -->
                            <!-- BEGIN USER LOGIN DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            <li class="dropdown dropdown-user dropdown-dark">
                                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown"
                                   data-close-others="true">
                                    <span class="username username-hide-on-mobile"><span id="username"></span></span>
                                    <!-- DOC: Do not remove below empty space(&nbsp;) as its purposely used -->
                                    <!--<img alt="" class="img-circle" src="../assets/layouts/layout4/img/avatar9.jpg"/> -->
                                </a>
                                <ul class="dropdown-menu dropdown-menu-default">
                                    <li>
                                        <a href="login.html" onclick="logout()">
                                            <i class="icon-key"></i> Log Out </a>
                                    </li>
                                </ul>
                            </li>
                            <!-- END USER LOGIN DROPDOWN -->
                            <!-- BEGIN QUICK SIDEBAR TOGGLER -->
                            <!-- BEGIN QUICK SIDEBAR TOGGLER -->
                            <!-- END QUICK SIDEBAR TOGGLER -->
                        </ul>
                    </div>
                    <!-- END TOP NAVIGATION MENU -->
                </div>
                <!-- END PAGE TOP -->
            </div>
            <!-- END HEADER INNER -->
        </div>
        <!-- END HEADER -->
        <!-- BEGIN HEADER & CONTENT DIVIDER -->
        <div class="clearfix"> </div>
        <!-- END HEADER & CONTENT DIVIDER -->
        <!-- BEGIN CONTAINER -->
        <div class="page-container">
            <!-- BEGIN SIDEBAR -->
            <div class="page-sidebar-wrapper">
                <!-- BEGIN SIDEBAR -->
                <!-- DOC: Set data-auto-scroll="false" to disable the sidebar from auto scrolling/focusing -->
                <!-- DOC: Change data-auto-speed="200" to adjust the sub menu slide up/down speed -->
                <div class="page-sidebar navbar-collapse collapse">
                    <div id="sidebar_menu"></div>
                </div>
                <!-- END SIDEBAR -->
            </div>
            <!-- END SIDEBAR -->
            <!-- BEGIN CONTENT -->
            <div class="page-content-wrapper">
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content">
                    <!-- BEGIN PAGE HEAD-->
                    <div class="page-head">
                        <!-- BEGIN PAGE TITLE -->
                        <div class="page-title">
                            <h1>Penjualan
                                <small>Pulsa</small>
                            </h1>
                        </div>
                        <!-- END PAGE TITLE -->
                    </div>
                    <!-- END PAGE HEAD-->
                    <!-- BEGIN PAGE BREADCRUMB -->
                    <ul class="page-breadcrumb breadcrumb">
                        <li>
                            <a href="report.html">Home</a>
                            <i class="fa fa-circle"></i>
                        </li>
                        <li>
                            <a href="#">Input Penjualan</a>
                            <i class="fa fa-circle"></i>
                        </li>
                        <li>
                            <span class="active">Penjualan Pulsa</span>
                        </li>
                    </ul>
                    <!-- END PAGE BREADCRUMB -->
                    <!-- BEGIN PAGE BASE CONTENT -->
                    <div class="row">
                        <div class="col-md-10 ">
                            <!-- BEGIN SAMPLE FORM PORTLET-->
                            <div class="portlet light bordered">
                                <div class="portlet-title">
                                    <div class="caption font-red-sunglo">
                                        <i class="icon-user-follow font-red"></i>
                                        <span class="caption-subject bold uppercase"> Form Input Penjualan Pulsa</span>
                                    </div>
                                </div>
                                <div class="portlet-body form">
                                    <form role="form">
                                        <div class="form-body">
                                            <div class="form-group">
                                                <label>ID Transaksi</label>
                                                <div class="input-icon">
                                                    <i class="fa fa-tags"></i>
                                                    <input type="text" class="form-control" id="id_transaksi" readonly> </div>
                                            </div>

                                            <div class="form-group">
                                                <label>Tanggal Transaksi</label>
                                                <div class="date-picker" data-date-format="yyyy/mm/dd" data-date=get_current_date() id="tanggal_transaksi"> </div>
                                            </div>

                                            <div class="form-group">
                                                <div class="col-md-4">
                                                <label>Operator</label>
                                                <div class="input-icon">
                                                    <i class="fa fa-tags"></i>
                                                    <input type="text" class="form-control" id="operator" readonly> </div>
                                                </div>

                                                <div class="col-md-6">
                                                    <label>No HP</label>
                                                    <div class="input-icon">
                                                        <i class="fa fa-tags"></i>
                                                        <input type="number" class="form-control" id="no_hp" onchange="get_operator_denom_by_prefix()" maxlength="13"> </div>
                                                </div>

                                                <div class="col-md-2">
                                                    <label>Denom</label>
                                                    <div class="input-icon">
                                                        <i class="fa fa-tags"></i>
                                                        <input type="text" class="form-control" id="denom" list="denom_list">
                                                        <datalist id="denom_list"></datalist></div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <br></br>
                                                <br></br>
                                            </div>

                                            <div class="form-group">
                                                <label>Catatan</label>
                                                <textarea class="form-control" rows="3" id="catatan"></textarea>
                                            </div>
                                        <div class="form-actions">
                                            <button type="button" class="btn blue center-block" onclick="submit_data()">Submit</button>
<!--                                            <button type="button" class="btn default">Cancel</button>-->
                                        </div>
                                        </div>
                                    </form>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- END PAGE BASE CONTENT -->
                </div>
                <!-- END CONTENT BODY -->
            </div>
            <!-- END CONTENT -->
            <!-- BEGIN QUICK SIDEBAR -->
            <a href="javascript:;" class="page-quick-sidebar-toggler">
                <i class="icon-login"></i>
            </a>
            <div class="page-quick-sidebar-wrapper" data-close-on-body-click="false">
                <div class="page-quick-sidebar">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a href="javascript:;" data-target="#quick_sidebar_tab_1" data-toggle="tab"> Users
                                <span class="badge badge-danger">2</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:;" data-target="#quick_sidebar_tab_2" data-toggle="tab"> Alerts
                                <span class="badge badge-success">7</span>
                            </a>
                        </li>
                        <li class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"> More
                                <i class="fa fa-angle-down"></i>
                            </a>
                            <ul class="dropdown-menu pull-right">
                                <li>
                                    <a href="javascript:;" data-target="#quick_sidebar_tab_3" data-toggle="tab">
                                        <i class="icon-bell"></i> Alerts </a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-target="#quick_sidebar_tab_3" data-toggle="tab">
                                        <i class="icon-info"></i> Notifications </a>
                                </li>
                                <li>
                                    <a href="javascript:;" data-target="#quick_sidebar_tab_3" data-toggle="tab">
                                        <i class="icon-speech"></i> Activities </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="javascript:;" data-target="#quick_sidebar_tab_3" data-toggle="tab">
                                        <i class="icon-settings"></i> Settings </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- END QUICK SIDEBAR -->
        </div>
        <!-- END CONTAINER -->
        <!-- BEGIN FOOTER -->
        <div class="page-footer">
            <div class="page-footer-inner"> 2016 &copy; Metronic Theme By
                <a target="_blank" href="http://keenthemes.com">Keenthemes</a> &nbsp;|&nbsp;
                <a href="http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes" title="Purchase Metronic just for 27$ and get lifetime updates for free" target="_blank">Purchase Metronic!</a>
            </div>
            <div class="scroll-to-top">
                <i class="icon-arrow-up"></i>
            </div>
        </div>
        <!-- END FOOTER -->
        <!-- BEGIN QUICK NAV -->
        <div class="quick-nav-overlay"></div>
        <!-- END QUICK NAV -->
        <!--[if lt IE 9]>
<script src="../assets/global/plugins/respond.min.js"></script>
<script src="../assets/global/plugins/excanvas.min.js"></script> 
<script src="../assets/global/plugins/ie8.fix.min.js"></script> 
<![endif]-->
        <!-- BEGIN CORE PLUGINS -->
        <!--<script src="../assets/global/plugins/jquery.min.js" type="text/javascript"></script>-->
        <script src="../assets/global/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
        <link href="../assets/global/plugins/bootstrap-sweetalert/sweetalert.css" rel="stylesheet" type="text/css" />
        <!-- END CORE PLUGINS -->
        <!-- BEGIN THEME GLOBAL SCRIPTS -->
        <script src="../assets/global/scripts/app.min.js" type="text/javascript"></script>
        <!-- END THEME GLOBAL SCRIPTS -->
        <!-- BEGIN THEME LAYOUT SCRIPTS -->
        <script src="../assets/layouts/layout4/scripts/layout.min.js" type="text/javascript"></script>
        <script src="../assets/layouts/layout4/scripts/demo.min.js" type="text/javascript"></script>
        <script src="../assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
        <script src="../assets/layouts/global/scripts/quick-nav.min.js" type="text/javascript"></script>
        <script src="../assets/pages/scripts/ui-sweetalert.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-sweetalert/sweetalert.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/moment.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
        <!-- END THEME LAYOUT SCRIPTS -->
        <script src="../assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>

    <script>

        $(document).ready(function (){
            if(sessionStorage.getItem("username") == null || sessionStorage.getItem("username") == "") {
                window.location.href = 'login.html';
            }
            var display_uname = "Hello, Selamat datang " + sessionStorage.getItem("username");
            document.getElementById('username').innerHTML = display_uname;
            // document.getElementById("datetimepicker1").value = moment().format("YYYY-MM-DD");

            function logout() {
                sessionStorage.removeItem("username");
                window.location.href = 'login.html'
            }

            var denom_list = "";

            $.ajax({
                type: "GET",
                url: "http://149.129.241.157:5000/penjualan_pulsa_get_id",
                // The key needs to match your method's input parameter (case-sensitive).
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(data){
                    console.log(data);
                    var msg = data['msg'];
                    var response = data['response'];
                    console.log(msg);
                    if (data['response'] == 'OK') {
                       document.getElementById("id_transaksi").value = msg;
                       // document.getElementById("nama_anggota").value= msg;
                    } else {
                        swal("Internal Error!!", "Gagal generate ID Transaksi", "error");
                    }
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    swal("Internal Error!!", "Gagal generate ID Transaksi, Mohon Cek API", "error");
                }
            });

            $(".form-group").keypress(function (e) {
                if (e.which == '13') {
                    submit_data();
                }
            });


        });

        function get_current_date(){
            var date_input = new Date();
            var day = date_input.getDate();
            var month = date_input.getMonth() + 1;
            var year = date_input.getFullYear();
            var yyyy_MM_dd = year + "-" + month + "-" + day;
            return yyyy_MM_dd;
        }

        function hitung_keuntungan() {
            var keuntungan = $("#harga_jual").val() - $("#harga_beli").val();
            document.getElementById("keuntungan").value = keuntungan;

        }

        function get_operator_denom_by_prefix(){
            var json_obj = new Object();
            json_obj.no_hp =  $("#no_hp").val();
            $.ajax({
                type: "POST",
                url: "http://149.129.241.157:5000/get_operator_denom_by_prefix",
                // The key needs to match your method's input parameter (case-sensitive).
                contentType: "application/json; charset=utf-8",
                
                data: JSON.stringify(json_obj),
                dataType: "json",
                success: function(data){
                    console.log(data);
                    var nama_operator = data['nama_operator'];
                    if (data['response'] == 'OK') {
                        document.getElementById("operator").value = nama_operator;
                        // document.getElementById("nama_anggota").value= msg;
                        var options = '';
                        var list_denom = data['denom_arr'];
                        console.log(list_denom);
                        denom_list = list_denom
                        for (var i = 0; i < list_denom.length; i++){
                            var o_value = list_denom[i];
                            options += '<option value="'+o_value+'">'+o_value+'</option>';
                            console.log(o_value);
                        }
                        document.getElementById('denom_list').innerHTML = options;
                    } else {
                        swal("Internal Error!!", "Gagal generate ID Transaksi", "error");
                    }
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    swal("Internal Error!!", "Gagal generate ID Transaksi, Mohon Cek API", "error");
                }
            });
        }

        function input_validation(){
            if ($("#no_hp").val() == ""){
                swal("ERROR!!!", "No HP belum diisi", "warning");
                $("#no_hp").focus();
                return false;
            }

            if ($("#denom").val() == ""){
                swal("ERROR!!!", "Denom / Nama produk belum diisi", "warning");
                $("#denom").focus();
                return false;
            }

            if (jQuery.inArray( $("#denom").val(), denom_list) == -1){

                swal("ERROR!!!", "Denom tidak sesuai dengan product yang disediakan operator", "warning");
                $("#denom").focus();
                return false;
            }
            return true;

            alert("end validation")
        }

        function submit_data () {
            if (!input_validation()) {
                return;
            }

            var dateObject = $("#tanggal_transaksi").datepicker('getDate');
            console.log($.datepicker.formatDate('yy-mm-dd', dateObject));

            // alert("tembak belakang") testing
            var json_obj = new Object();
            json_obj.tanggal_registrasi = $.datepicker.formatDate('yy-mm-dd', dateObject);
            json_obj.id_transaksi = $("#id_transaksi").val();
            json_obj.operator = $("#operator").val();
            json_obj.no_hp = $("#no_hp").val();
            json_obj.denom = $("#denom").val();
            json_obj.catatan = $("#catatan").val();
            console.log(json_obj);
            console.log(JSON.stringify(json_obj));
            swal({
                title: "Yakin data sudah benar?",
                text: "You will not be able to recover this imaginary file!",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes, data sudah benar!",
                closeOnConfirm: false
            }, function (isConfirm) {
                if (!isConfirm) return;
                //swal("Done!", "MAAF FUNGSINYA MASIH DUMMY!", "success");
                $.ajax({
                    url: "http://149.129.241.157:5000/input_penjualan_pulsa",
                    type: "POST",
                    data: JSON.stringify(json_obj),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        console.log(data);
                        if (data['response'] == 'NOK') {
                            swal("Error!", data['msg'], "warning");
                            $('#no_hp').focus
                            return;
                        }
                        else {
                            swal("Done!", "registrasi berhasil!", "success");
                            setTimeout(
                            function()
                            {
                                window.location.href="report.html"
                            }, 1500);
                        }
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        swal("Error Saat registrasi!", "Please try again", "error");
                    }
                });
            });
        }
    </script>

    </body>

</html>